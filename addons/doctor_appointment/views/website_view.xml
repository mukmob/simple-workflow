<odoo>
    <template id="portal_my_home_appointment" name="Show Appointment" inherit_id="portal.portal_my_home" priority="45">
        <xpath expr="//div[contains(@class, 'o_portal_docs')]" position="before">
            <t t-set="portal_service_category_enable" t-value="True"/>
            <div >
                <!-- Left side (3 items) -->
                <div >
                    <!-- Appointments -->
                    <a class="list-group-item list-group-item-action d-flex align-items-center justify-content-start" href="/my/Appointment">
                        <div>
                            <h6 class="mt-0 mb-1">
                                <span>Book an Appointment</span>
                            </h6>
                        </div>
                    </a>
                    <!-- Doctors appointments -->
                    <a class="list-group-item list-group-item-action d-flex align-items-center justify-content-start" href="/my/Doctors">
                        <div>
                            <h6 class="mt-0 mb-1">
                                <span>Doctor's Appointments</span>
                            </h6>

                        </div>
                    </a>
                </div>

                <!-- Time Slots -->

                <a class="list-group-item list-group-item-action d-flex align-items-center justify-content-start" href="/my/appointmentlist">
                    <div>
                        <h6 class="mt-0 mb-1">
                            <span>Booked Appointments</span>
                        </h6>
                    </div>
                </a>


            </div>
        </xpath>
    </template>

    <!-- appointment table -->
    <template id="portal_appointment_table_layout" name="Appointmentlist">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>

            <t t-call="portal.portal_searchbar">
                <t t-set="title">Appointments</t>
            </t>
            <!-- Filter Section -->
            <div class="container justify-content-around">
                <div class="row mb-3 justify-content-between">
                    <!-- From Date Filter -->
                    <div class="col-md-6 col-lg-4 mb-3">
                        <label for="from-date-filter" class="form-label">From Date:</label>
                        <input type="date" id="from-date-filter" class="form-control" onchange="filterAppointments()"/>
                    </div>

                    <!-- To Date Filter -->
                    <div class="col-md-6 col-lg-4 mb-3">
                        <label for="to-date-filter" class="form-label">To Date:</label>
                        <input type="date" id="to-date-filter" class="form-control" onchange="filterAppointments()"/>
                    </div>

                    <!-- Status Filter -->
                    <div class="col-md-6 col-lg-4 mb-3">
                        <label for="status-filter" class="form-label">Filter by Status:</label>
                        <select id="status-filter" class="form-control" onchange="filterAppointments()">
                            <option value="">All</option>
                            <option value="Confirm">Confirm</option>
                            <option value="Done">Done</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="d-flex justify-content-center">
                <table class="table">
                    <thead>
                        <tr>
                            <th class="text-left" style="white-space: nowrap;">Appointment ID</th>
                            <th class="text-left" style="white-space: nowrap;">Appointment Date</th>
                            <th class="text-left" style="white-space: nowrap;">Doctor Name</th>
                            <th class="text-left" style="white-space: nowrap;">Customer Name</th>
                            <th class="text-left" style="white-space: nowrap;">Customer Phone</th>
                            <th class="text-left" style="white-space: nowrap;">Customer Email</th>
                            <th class="text-left" style="white-space: nowrap;">Service</th>
                            <th class="text-left" style="white-space: nowrap;">Duration</th>
                            <th class="text-left" style="white-space: nowrap;">Price</th>
                            <th class="text-left" style="white-space: nowrap;">Payment</th>
                            <th class="text-left" style="white-space: nowrap;">Status</th>
                        </tr>
                    </thead>
                    <tbody id="appointments-table-body">
                        <t t-foreach="docs" t-as="appointment">
                            <tr t-att-data-status="appointment.state" t-att-data-appointment-date="appointment.appointment_date">
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-esc="appointment.customer_sequence"/>
                                </td>
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-esc="appointment.appointment_date"/>
                                </td>
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-esc="appointment.doctor_id.name"/>
                                </td>
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-esc="appointment.partner_id.name"/>
                                </td>
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-esc="appointment.contact"/>
                                </td>
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-esc="appointment.email"/>
                                </td>
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-foreach="appointment.service_ids" t-as="service" t-esc="service.name"/>
                                </td>
                                <td class="text-left" style="white-space: nowrap;">30 mins</td>
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-esc="appointment.price"/>
                                </td>
                                <td class="text-left" style="white-space: nowrap;">Paid</td>
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-esc="appointment.state"/>
                                </td>
                            </tr>
                        </t>
                    </tbody>
                </table>
            </div>
        </t>
        <script type="text/javascript">
        function filterAppointments() {
            var statusFilterValue = document.getElementById('status-filter').value;
        var fromDateFilterValue = document.getElementById('from-date-filter').value;
        var toDateFilterValue = document.getElementById('to-date-filter').value;
        var rows = document.querySelectorAll('#appointments-table-body tr');
        
        rows.forEach(function(row) {
            var status = row.getAttribute('data-status');
            var appointmentDate = row.getAttribute('data-appointment-date');

            // Convert the appointment date to a Date object
            var appointmentDateObj = new Date(appointmentDate);
            
            // Convert from and to filter dates to Date objects
            var fromDateObj = fromDateFilterValue ? new Date(fromDateFilterValue) : null;
            var toDateObj = toDateFilterValue ? new Date(toDateFilterValue) : null;
            
            // Check if the status matches (OR condition)
            var statusMatch = statusFilterValue === "" || status.toLowerCase() === statusFilterValue.toLowerCase();

            // Check if the appointment date matches the date range (AND condition)
            var dateMatch = true;
            if (fromDateObj &amp;&amp; appointmentDateObj &lt; fromDateObj) {
                dateMatch = false;  // Appointment is before the "from" date
            }
            if (toDateObj &amp;&amp; appointmentDateObj &gt; toDateObj) {
                dateMatch = false;  // Appointment is after the "to" date
            }

            // Show or hide row based on the filters
            if (statusMatch &amp;&amp; dateMatch) {
                row.style.display = '';  // Show the row
            } else {
                row.style.display = 'none';  // Hide the row
            }
        });

        }
        </script>
    </template>


    <template id="portal_doctor_appointment_table_layout" name="Doctor Appointments">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>

            <t t-call="portal.portal_searchbar">
                <t t-set="title">Doctor Appointments</t>
            </t>

            <!-- Filter Section -->
            <div class="container justify-content-around">
                <div class="row mb-3 justify-content-between">
                    <!-- From Date Filter -->
                    <div class="col-md-6 col-lg-4 mb-3">
                        <label for="from-date-filter" class="form-label">From Date:</label>
                        <input type="date" id="from-date-filter" class="form-control" onchange="filterAppointments()"/>
                    </div>

                    <!-- To Date Filter -->
                    <div class="col-md-6 col-lg-4 mb-3">
                        <label for="to-date-filter" class="form-label">To Date:</label>
                        <input type="date" id="to-date-filter" class="form-control" onchange="filterAppointments()"/>
                    </div>

                    <!-- Status Filter -->
                    <div class="col-md-6 col-lg-4 mb-3">
                        <label for="status-filter" class="form-label">Filter by Status:</label>
                        <select id="status-filter" class="form-control" onchange="filterAppointments()">
                            <option value="">All</option>
                            <option value="Confirm">Confirm</option>
                            <option value="Done">Done</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="d-flex justify-content-center">
                <table class="table">
                    <thead>
                        <tr>
                            <th class="text-left" style="white-space: nowrap;">Appointment ID</th>
                            <th class="text-left" style="white-space: nowrap;">Appointment Date</th>
                            <t t-if="request.env.user.has_group('base.group_system')">
                                <th class="text-left" style="white-space: nowrap;">Doctor Name</th>
                            </t>
                            <th class="text-left" style="white-space: nowrap;">Customer Name</th>
                            <th class="text-left" style="white-space: nowrap;">Customer Phone</th>
                            <th class="text-left" style="white-space: nowrap;">Customer Email</th>
                            <th class="text-left" style="white-space: nowrap;">Services</th>
                            <th class="text-left" style="white-space: nowrap;">Duration</th>
                            <th class="text-left" style="white-space: nowrap;">Price</th>
                            <th class="text-left" style="white-space: nowrap;">Payment</th>
                            <th class="text-left" style="white-space: nowrap;">Status</th>
                        </tr>
                    </thead>
                    <tbody id="appointments-table-body">
                        <t t-foreach="docs" t-as="appointment">
                            <tr t-att-data-status="appointment.state" t-att-data-appointment-date="appointment.appointment_date">
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-esc="appointment.customer_sequence"/>
                                </td>
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-esc="appointment.appointment_date"/>
                                </td>
                                <t t-if="request.env.user.has_group('base.group_system')">
                                    <td class="text-left" style="white-space: nowrap;">
                                        <t t-esc="appointment.doctor_id.name"/>
                                    </td>
                                </t>
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-esc="appointment.partner_id.name"/>
                                </td>
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-esc="appointment.contact"/>
                                </td>
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-esc="appointment.email"/>
                                </td>
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-foreach="appointment.service_ids" t-as="service" t-esc="service.name"/>
                                </td>
                                <td class="text-left" style="white-space: nowrap;">30 mins</td>
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-esc="appointment.price"/>
                                </td>
                                <td class="text-left" style="white-space: nowrap;">Paid</td>
                                <td class="text-left" style="white-space: nowrap;">
                                    <t t-esc="appointment.state"/>
                                </td>
                                <td>
                                    <t t-if="appointment.state != 'done'">
                                        <form action="/my/Doctors/mark_done" method="post" style="display:inline;">
                                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                            <input type="hidden" name="appointment_id" t-att-value="appointment.id"/>
                                            <button type="submit" class="btn btn-success btn-sm">Done</button>
                                        </form>
                                    </t>
                                </td>
                            </tr>
                        </t>
                    </tbody>
                </table>
            </div>
        </t>

        <script type="text/javascript">
        function filterAppointments() {
            var statusFilterValue = document.getElementById('status-filter').value;
        var fromDateFilterValue = document.getElementById('from-date-filter').value;
        var toDateFilterValue = document.getElementById('to-date-filter').value;
        var rows = document.querySelectorAll('#appointments-table-body tr');
        
        rows.forEach(function(row) {
            var status = row.getAttribute('data-status');
            var appointmentDate = row.getAttribute('data-appointment-date');

            // Convert the appointment date to a Date object
            var appointmentDateObj = new Date(appointmentDate);
            
            // Convert from and to filter dates to Date objects
            var fromDateObj = fromDateFilterValue ? new Date(fromDateFilterValue) : null;
            var toDateObj = toDateFilterValue ? new Date(toDateFilterValue) : null;
            
            // Check if the status matches (OR condition)
            var statusMatch = statusFilterValue === "" || status.toLowerCase() === statusFilterValue.toLowerCase();

            // Check if the appointment date matches the date range (AND condition)
            var dateMatch = true;
            if (fromDateObj &amp;&amp; appointmentDateObj &lt; fromDateObj) {
                dateMatch = false;  // Appointment is before the "from" date
            }
            if (toDateObj &amp;&amp; appointmentDateObj &gt; toDateObj) {
                dateMatch = false;  // Appointment is after the "to" date
            }

            // Show or hide row based on the filters
            if (statusMatch &amp;&amp; dateMatch) {
                row.style.display = '';  // Show the row
            } else {
                row.style.display = 'none';  // Hide the row
            }
        });

        }
        </script>
    </template>


    <!--5. Done thank you page -->
    <template id="medical_booking_done_5" name="Medical Booking Done">
        <t t-set="css_link" t-value="'/doctor_appointment_booking_odoo_stg/static/src/css/secondstep.css'"/>
        <link t-att-href="css_link" rel="stylesheet"/>
        <t t-call="website.layout">

            <div class="container">
                <div class="no-padding-margin">
                    <t t-set="breadcrumbs_searchbar" t-value="True"/>
                    <t t-call="portal.portal_searchbar">
                        <t t-set="title">Appointments</t>
                    </t>
                </div>
                <div class="progress-container mb-3">
                    <div class="progress-step">
                        <div class="step-label">1. Select Service</div>
                        <div class="progress-bar-wrapper">
                            <div class="progress-bar active"></div>
                        </div>
                    </div>
                    <div class="progress-step">
                        <div class="step-label">2. Timeslot</div>
                        <div class="progress-bar-wrapper">
                            <div class="progress-bar active"></div>
                        </div>
                    </div>
                    <div class="progress-step">
                        <div class="step-label">3. Add details</div>
                        <div class="progress-bar-wrapper">
                            <div class="progress-bar active"></div>
                        </div>
                    </div>
                    <div class="progress-step">
                        <div class="step-label">4. Confirm and Payment</div>
                        <div class="progress-bar-wrapper">
                            <div class="progress-bar active"></div>
                        </div>
                    </div>
                    <div class="progress-step">
                        <div class="step-label">5. Done</div>
                        <div class="progress-bar-wrapper">
                            <div class="progress-bar active"></div>
                        </div>
                    </div>
                </div>
                <t t-if="error_message">
                    <div style="border: 1px solid red; background-color: #ffe6e6; color: red; padding: 10px; margin-bottom: 20px; text-align: center;">
                        <t t-esc="error_message" />
                    </div>
                </t>
                <!-- Booking Complete Message -->
                <div class="row mb-3">
                    <div class="col">
                        <p class="fontsize-1 customfont" style="font-family: 'Julius Sans One', serif; font-size: 6rem;">
                            Thank you
                        </p>
                    </div>
                </div>


                <div class="row mb-2">
                    <div class="col">
                        <p class="fontsize-1 fw-bold">
                        Your booking is complete. An 
                            <span class="text-primary fontsize-1">email with details of your booking</span> 
                        has been sent to you.
                        </p>
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-12">

                        <img t-att-src="'/doctor_appointment_booking_odoo_stg/static/src/img/d.png'" alt="Done" style=""/>

                    </div>
                </div>
            </div>
        </t>
    </template>


    <!--4. Confirm and Payment -->
    <template id="medical_booking_4" name="Medical Booking Done">
        <t t-set="css_link" t-value="'/doctor_appointment_booking_odoo_stg/static/src/css/secondstep.css'"/>
        <link t-att-href="css_link" rel="stylesheet"/>
        <t t-call="website.layout">
            <div class="container mt-5">
                <!-- Progress Bar -->
                <div class="progress-container mb-3">
                    <div class="progress-step">
                        <div class="step-label">1. Select Service</div>
                        <div class="progress-bar-wrapper">
                            <div class="progress-bar active"></div>
                        </div>
                    </div>
                    <div class="progress-step">
                        <div class="step-label">2. Timeslot</div>
                        <div class="progress-bar-wrapper">
                            <div class="progress-bar active"></div>
                        </div>
                    </div>
                    <div class="progress-step">
                        <div class="step-label">3. Add details</div>
                        <div class="progress-bar-wrapper">
                            <div class="progress-bar active"></div>
                        </div>
                    </div>
                    <div class="progress-step">
                        <div class="step-label">4. Confirm and Payment</div>
                        <div class="progress-bar-wrapper">
                            <div class="progress-bar active"></div>
                        </div>
                    </div>
                    <div class="progress-step">
                        <div class="step-label">5. Done</div>
                        <div class="progress-bar-wrapper">
                            <div class="progress-bar inactive"></div>
                        </div>
                    </div>
                </div>

                <!-- Details Section -->
                <div class="row mb-3">
                    <div class="col">
                        <p class="fontsize-1">
                        You selected to book 
                            <span class="text-primary fontsize-1">
                                <b>
                                    <t t-esc="selected_doctor"/>
                                </b>
                            </span> 
                        by <span class="text-primary fontsize-1">clinic name</span> at 
                            <span class="text-primary fontsize-1">
                                <b>
                                    <t t-esc="selectedTime"/>
                                </b>
                            </span> 
                        on <span class="text-primary fontsize-1">
                            <b>
                                <t t-esc="formatted_date"/>
                            </b>
                        </span> 
                        for the <span class="text-primary fontsize-1">
                        <b>
                            <t t-esc="service_name"/>
                        </b>
                    </span>. 
                        The cost is <span class="text-primary fontsize-1">
                    <b>
                        <t t-esc="price_with_currency"/>
                    </b>
                </span>.
            </p>
        </div>
    </div>
    <br/>
    <hr/>
    <br/>

    <!-- Payment Options -->
    <div class="row mb-3">
        <div class="col">
            <p class="fontsize-1 fw-bold">Please tell us how you would like to pay:</p>
        </div>
    </div>
    <div class="col-12">
        <div class="form-check">
            <input class="form-check-input" type="radio" name="payment_option" value="local" id="pay_local" onchange="updatePaymentValue()" />
            <label class="form-check-label" for="pay_local">I will pay locally</label>
            <br />
            <input class="form-check-input" type="radio" name="payment_option" value="paypal" id="pay_paypal" onchange="updatePaymentValue()" />
            <label class="form-check-label" for="pay_paypal">
                        I will pay now with PayPal
                <img t-att-src="'/doctor_appointment_booking_odoo_stg/static/src/img/p.png'" alt="" />
            </label>
        </div>
        <span id="paymentError" class="text-danger" style="display:none;">Please select one option.</span>
    </div>
    <br/>
    <hr/>
    <br/>

    <!-- Navigation Buttons -->
    <div class="row mt-2 p-md-0 justify-content-end">

        <div class="col col-lg-2 text-end">
            <form method="post" action="/booking/step5" id="paymentForm">
                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                <input type="hidden" name="doctor_name" t-att-value="selected_doctor" />
                <input type="hidden" t-att-value="service_name" name="service_name" />
                <input type="hidden" t-att-value="price" name="price" />
                <input type="hidden" t-att-value="price_with_currency" name="price_with_currency" />
                <input type="hidden" t-att-value="user_email" name="user_email" />
                <input type="hidden" t-att-value="user_name" name="user_name" />
                <input type="hidden" t-att-value="user_contact_no" name="user_contact_no" />
                <input type="hidden" t-att-value="accountCheckbox" name="accountCheckbox" />
                <input type="hidden" t-att-value="user_password" name="user_password" />
                <input type="hidden" name="selectedTime" id="selectedTime" t-att-value="selectedTime" />
                <input type="hidden" name="selectedDate" id="selectedDate" t-att-value="selectedDate" />
                <input type="hidden" name="selected_payment_option" id="selected_payment_option"/>
                <input type="hidden" name="street" id="street" t-att-value="street"/>
                <input type="hidden" name="city" id="city" t-att-value="city"/>
                <input type="hidden" name="zipcode" id="zipcode" t-att-value="zipcode"/>
                <input type="hidden" name="country" id="country" t-att-value="country"/>
                <input type="hidden" name="state" id="state" t-att-value="state"/>
                <button class="btn btn-primary text-center mt-3 px-5 py-3" type="submit" onclick="return validatePaymentOption()">Next</button>
            </form>
        </div>
    </div>
</div>
<br/>
<br/>

<script>
            function updatePaymentValue() {
                const selectedOption = document.querySelector('input[name="payment_option"]:checked');
                const paymentInput = document.getElementById('selected_payment_option');

                if (selectedOption) {
                    paymentInput.value = selectedOption.value;
                }
            }

            function validatePaymentOption() {
                const selectedOption = document.querySelector('input[name="payment_option"]:checked');
                const errorElement = document.getElementById('paymentError');

                if (!selectedOption) {
                    errorElement.style.display = 'block';
                    return false;
                } else {
                    errorElement.style.display = 'none';
                    return true;
                }
            }
</script>
</t>
</template>


<!--3. Add details -->
<template id="medical_booking_3" name="Medical Booking Done">
<t t-call="website.layout">
<t t-set="css_link" t-value="'/doctor_appointment_booking_odoo_stg/static/src/css/secondstep.css'"/>
<link t-att-href="css_link" rel="stylesheet"/>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"/>
<div class="container mt-5">
    <div class="progress-container mb-3">
        <div class="progress-step">
            <div class="step-label">1. Select Service</div>
            <div class="progress-bar-wrapper">
                <div class="progress-bar active"></div>
            </div>
        </div>
        <div class="progress-step">
            <div class="step-label">2. Timeslot</div>
            <div class="progress-bar-wrapper">
                <div class="progress-bar active"></div>
            </div>
        </div>
        <div class="progress-step">
            <div class="step-label">3. Add details</div>
            <div class="progress-bar-wrapper">
                <div class="progress-bar active"></div>
            </div>
        </div>
        <div class="progress-step">
            <div class="step-label">4. Confirm and Payment</div>
            <div class="progress-bar-wrapper">
                <div class="progress-bar inactive"></div>
            </div>
        </div>
        <div class="progress-step">
            <div class="step-label">5. Done</div>
            <div class="progress-bar-wrapper">
                <div class="progress-bar inactive"></div>
            </div>
        </div>
    </div>

    <div class="row mb-3">
        <div class="col">
            <p class="fontsize-1 fw-bold">
                        Please provide details in the form below to proceed with booking.
            </p>
        </div>
    </div>
    <form method="post" action="/booking/step4" id="bookingForm">


        <div class="row">
            <div class="col-12 col-md-4 mb-4">
                <label for="name" class="mb-1 fw-bold">Name</label>
                <input type="text" class="form-control" placeholder="Enter full name" name="user_name" t-att-value="user_name" id="user_name"/>
                <div id="nameError" style="color: red; display: none;">Please enter your name.</div>
            </div>
            <div class="col-12 col-md-4 mb-4">
                <label for="phone" class="mb-1 fw-bold">Phone number</label>
                <input type="text" class="form-control" placeholder="Add contact number" name="user_contact_no" t-att-value="user_contact_no" id="user_contact_no"/>
                <div id="phoneError" style="color: red; display: none;">Please enter a valid 10-digit phone number.</div>
            </div>
            <div class="col-12 col-md-4 mb-4">
                <label for="email" class="mb-1 fw-bold">Email ID</label>
                <input type="text" class="form-control" placeholder="Enter email ID" name="user_email" t-att-value="user_email" id="user_email"/>
                <div id="emailError" style="color: red; display: none;">Please enter a valid email address.</div>
            </div>
        </div>


        <div class="row">
            <div class="col-12 col-md-4 mb-4">
                <label for="street" class="mb-1 fw-bold">Street and Number</label>
                <input type="text" class="form-control" placeholder="Enter street and number" name="street" t-att-value="street" id="street"/>
                <div id="streetError" style="color: red; display: none;">Please enter a valid street and number.</div>
            </div>
            <div class="col-12 col-md-4 mb-4">
                <label for="city" class="mb-1 fw-bold">City</label>
                <input type="text" class="form-control" placeholder="Enter city" name="city" t-att-value="city" id="city"/>
                <div id="cityError" style="color: red; display: none;">Please enter your city name.</div>
            </div>
            <div class="col-12 col-md-4 mb-4">
                <label for="zipcode" class="mb-1 fw-bold">Zip Code</label>
                <input type="text" class="form-control" placeholder="Zip Code" name="zipcode" t-att-value="zipcode" id="zipcode"/>
                <div id="zipcodeError" style="color: red; display: none;">Please enter a valid Zip Code (6 digits).</div>
            </div>
        </div>
        <div class="row mb-4">
            <div class="col-6">
                <label for="country" class="mb-1 fw-bold">Country</label>
                <input type="text" class="form-control" placeholder="Country" name="country" t-att-value="country" id="country"/>
                <div id="countryError" style="color: red; display: none;">Please enter your country.</div>
            </div>
            <div class="col-6">
                <label for="state" class="mb-1 fw-bold">State</label>
                <input type="text" class="form-control" placeholder="State" name="state" t-att-value="state" id="state"/>
                <div id="stateError" style="color: red; display: none;">Please enter your state.</div>
            </div>
        </div>



        <div class="row">
            <div class="col-12">
                <div class="form-check mb-3">
                    <input class="form-check-input" type="checkbox" id="accountCheckbox" name="accountCheckbox" t-att-value="accountCheckbox"/>
                    <label class="form-check-label" for="accountCheckbox">
                                Create an account
                    </label>
                </div>
                <div id="passwordField" style="display: none; margin-bottom:10px;">
                    <label for="password" class="mb-1 fw-bold">Password</label>
                    <div class="input-group">
                        <input type="password" class="form-control" placeholder="Enter Your password" name="user_password" id="user_password" t-att-value="user_password"/>
                        <button type="button" class="btn btn-secondary" id="togglePassword">
                            <i class="fas fa-eye-slash"></i>
                        </button>
                    </div>
                    <div id="passwordError" style="color: red; display: none;">Please enter a password.</div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">

                <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked"/>
                    <label class="form-check-label" for="flexCheckChecked">
                            I agree to the terms of service
                    </label>
                    <div id="termsError" style="color: red; display: none;">You must agree to the terms of service.</div>
                </div>
            </div>
        </div>
        <br/>
        <hr/>
        <br/>
        <div class="row mt-2 p-md-0 justify-content-end">

            <div class="col col-lg-2 text-end">
                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                <input type="hidden" name="doctor_name" t-att-value="selected_doctor"/>
                <input type="hidden" name="selected_treatment_id" t-att-value="selected_treatment_id"/>
                <input type="hidden" name="selectedTime" id="selectedTime" t-att-value="selectedTime"/>
                <input type="hidden" name="selectedDate" id="selectedDate" t-att-value="selectedDate"/>
                <button class="btn btn-primary text-center mt-3 px-5 py-3" type="submit">Next</button>
            </div>
        </div>
    </form>
</div>

<br/>
<br/>

<script type="text/javascript">
                document.getElementById('accountCheckbox').addEventListener('change', function () {
                    var passwordField = document.getElementById('passwordField');
                    passwordField.style.display = this.checked ? 'block' : 'none';
                });

                // Toggle password visibility
                document.getElementById('togglePassword').addEventListener('click', function () {
                    var passwordInput = document.getElementById('user_password');
                    var passwordIcon = this.querySelector('i');

                    if (passwordInput.type === 'password') {
                        passwordInput.type = 'text';
                        passwordIcon.classList.remove('fa-eye-slash');
                        passwordIcon.classList.add('fa-eye');
                    } else {
                        passwordInput.type = 'password';
                        passwordIcon.classList.remove('fa-eye');
                        passwordIcon.classList.add('fa-eye');
                    }
                });

                document.getElementById('bookingForm').addEventListener('submit', function(event) {
                    var valid = true;

                    // Clear previous errors
                    document.getElementById('nameError').style.display = 'none';
                    document.getElementById('phoneError').style.display = 'none';
                    document.getElementById('emailError').style.display = 'none';
                    document.getElementById('passwordError').style.display = 'none';
                    document.getElementById('termsError').style.display = 'none';

                    // Validate Name
                    var name = document.getElementById('user_name').value;
                    if (!name) {
                        document.getElementById('nameError').style.display = 'block';
                        valid = false;
                    }

                    // Validate Phone Number (must be at least 10 digits)
                    var phone = document.getElementById('user_contact_no').value;
                    var phoneRegex = /^[0-9]{10}$/;
                    if (!phone || !phoneRegex.test(phone)) {
                        document.getElementById('phoneError').style.display = 'block';
                        valid = false;
                    }

                    // Validate Email
                    var email = document.getElementById('user_email').value;
                    var emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
                    if (!email || !emailRegex.test(email)) {
                        document.getElementById('emailError').style.display = 'block';
                        valid = false;
                    }

                    // Validate Password (only if the "Create an account" checkbox is checked)
                    var passwordField = document.getElementById('passwordField');
                    if (passwordField.style.display === 'block') {
                        var password = document.getElementById('user_password').value;
                        if (!password) {
                            document.getElementById('passwordError').style.display = 'block';
                            valid = false;
                        }
                    }

                    // Validate Terms of Service Checkbox
                    var termsCheckbox = document.getElementById('flexCheckChecked');
                    if (!termsCheckbox.checked) {
                        document.getElementById('termsError').style.display = 'block';
                        valid = false;
                    }

                    document.getElementById('streetError').style.display = 'none';
                    document.getElementById('cityError').style.display = 'none';
                    document.getElementById('zipcodeError').style.display = 'none';
                    document.getElementById('countryError').style.display = 'none';
                    document.getElementById('stateError').style.display = 'none';
                
                    // Validate Street and Number
                    var street = document.getElementById('street').value;
                    if (!street) {
                        document.getElementById('streetError').style.display = 'block';
                        valid = false;
                    }
                
                    // Validate City
                    var city = document.getElementById('city').value;
                    if (!city) {
                        document.getElementById('cityError').style.display = 'block';
                        valid = false;
                    }
                
                    // Validate Zip Code (must be 5 digits)
                    var zipcode = document.getElementById('zipcode').value;
                    var zipcodeRegex =  /^[0-9]{6}$/;
                    if (!zipcode || !zipcodeRegex.test(zipcode)) {
                        document.getElementById('zipcodeError').style.display = 'block';
                        valid = false;
                    }
                
                    // Validate Country
                    var country = document.getElementById('country').value;
                    if (!country) {
                        document.getElementById('countryError').style.display = 'block';
                        valid = false;
                    }
                
                    // Validate State
                    var state = document.getElementById('state').value;
                    if (!state) {
                        document.getElementById('stateError').style.display = 'block';
                        valid = false;
                    }
                
                
                    if (!valid) {
                        event.preventDefault(); // Prevent form submission
                    }
                });
</script>
</t>
</template>




<!-- 2. Timeslot -->
<template id="medical_booking_2" name="Medical Booking">
<t t-call="website.layout">
<t t-set="css_link" t-value="'/doctor_appointment_booking_odoo_stg/static/src/css/secondstep.css'"/>
<link t-att-href="css_link" rel="stylesheet"/>

<div class="container mt-5">
    <div class="progress-container mb-3">
        <div class="progress-step">
            <div class="step-label">1. Select Service</div>
            <div class="progress-bar-wrapper">
                <div class="progress-bar active"></div>
            </div>
        </div>
        <div class="progress-step">
            <div class="step-label">2. Timeslot</div>
            <div class="progress-bar-wrapper">
                <div class="progress-bar active"></div>
            </div>
        </div>
        <div class="progress-step">
            <div class="step-label">3. Add details</div>
            <div class="progress-bar-wrapper">
                <div class="progress-bar inactive"></div>
            </div>
        </div>
        <div class="progress-step">
            <div class="step-label">4. Confirm and Payment</div>
            <div class="progress-bar-wrapper">
                <div class="progress-bar inactive"></div>
            </div>
        </div>
        <div class="progress-step">
            <div class="step-label">5. Done</div>
            <div class="progress-bar-wrapper">
                <div class="progress-bar inactive"></div>
            </div>
        </div>
    </div>

    <div class="row mb-4">
        <div class="col">
            <p class="fontsize-1">
                        Below you can find list of available time slots for 
                <b>
                    <span class="text-primary fontsize-1">
                        <t t-esc="'Dr. ' + doctor_name"/>
                    </span>
                </b>
                        by <span class="text-primary fontsize-1">clinic name</span>. Click on a time slot to proceed with booking.
            </p>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6 mb-4">
            <div class="calendar-container">
                <h2 class="fontsize-1">Select a Date</h2>
                <div class="calendar-header">
                    <button id="prevMonth" class="prevbtn">&lt;</button>
                    <h3 id="monthYear"></h3>
                    <button id="nextMonth" class="nextbtn">&gt;</button>
                </div>
                <div class="weekdays">
                    <div>Su</div>
                    <div>Mo</div>
                    <div>Tu</div>
                    <div>We</div>
                    <div>Th</div>
                    <div>Fr</div>
                    <div>Sa</div>
                </div>
                <div class="calendar" id="calendar"></div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="time-slot-container">
                <h2 class="fontsize-1">Select a Time Slot</h2>
                <div id="timeSlots" class="time-slots">
                    <div id="slots-container" class="slots-container">
                        <t t-foreach="available_dates" t-as="day">
                            <t t-foreach="time_slots_by_day[day]" t-as="slot">
                                <button class="btn time-slot" t-att-data-time="slot[0]" onclick="setSelectedTime(this)">
                                    <t t-esc="slot[0] + ' - ' + slot[1]"/>
                                </button>
                            </t>
                        </t>
                    </div>
                </div>
            </div>
        </div>
        <script>
                    function setSelectedTime(button) {
                        var selectedTime = button.getAttribute('data-time');  
                        console.log(selectedTime);
                        document.getElementById("selectedTime").value = selectedTime;
                    }
        </script>
    </div>

    <div class="col-12">
        <div id="confirmation" class="confirmation hidden text-center">
            <h3>Appointment Confirmed</h3>
            <p id="confirmationText"></p>
        </div>
    </div>

    <br/>
    <hr/>
    <br/>

    <div class="row mt-2 p-md-0 justify-content-end">

        <div class="col col-lg-2 text-end">
            <form method="post" action="/booking/step3" onsubmit="return validateForm()">
                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                <input type="hidden" name="doctor_name" t-att-value="doctor_name"/>
                <input type="hidden" name="sub_doctor_id" id="sub_doctor_id" t-att-value="selected_doctor"/>
                <input type="hidden" t-att-value="selected_treatment_id" name="selected_treatment_id" />
                <input type="hidden" name="selectedTime" id="selectedTime"/>
                <input type="hidden" name="selectedDate" id="selectedDate"/>
                <input type="hidden" name="sub_dates" id="sub_dates" t-att-value="available_date"/>
                <button class="btn btn-primary text-center mt-3 px-5 py-3" type="submit">Next</button>
            </form>
        </div>

    </div>
</div>
<script type="text/javascript" src="/doctor_appointment_booking_odoo_stg/static/src/js/secondsteps.js"></script>
<br/>
<br/>
</t>
</template>


<!-- 1. Select Service -->
<template id="medical_booking_1" name="Medical Booking Done">
<t t-call="website.layout">
<t t-set="css_link" t-value="'/doctor_appointment_booking_odoo_stg/static/src/css/firststep.css'"/>
<link t-att-href="css_link" rel="stylesheet"/>

<div class="container mt-5">
    <div class="progress-container mb-3">
        <div class="progress-step">
            <div class="step-label">1. Select Service</div>
            <div class="progress-bar-wrapper">
                <div class="progress-bar active"></div>
            </div>
        </div>
        <div class="progress-step">
            <div class="step-label">2. Timeslot</div>
            <div class="progress-bar-wrapper">
                <div class="progress-bar inactive"></div>
            </div>
        </div>
        <div class="progress-step">
            <div class="step-label">3. Add details</div>
            <div class="progress-bar-wrapper">
                <div class="progress-bar inactive"></div>
            </div>
        </div>
        <div class="progress-step">
            <div class="step-label">4. Confirm and Payment</div>
            <div class="progress-bar-wrapper">
                <div class="progress-bar inactive"></div>
            </div>
        </div>
        <div class="progress-step">
            <div class="step-label">5. Done</div>
            <div class="progress-bar-wrapper">
                <div class="progress-bar inactive"></div>
            </div>
        </div>
    </div>

    <form method="get" action="/my/Appointment" class="w-100">
        <div class="row mb-4">
            <div class="col-md-5">
                <h5 class="head1 mb-4 fw-bold fontsize-1">Select Category</h5>
                <select style="height:25px; width:450px;" name="category_id" class="form-select" id="categorySelect" onchange="this.form.submit()">
                    <option value="">-- Select Category --</option>
                    <t t-foreach="categories" t-as="category">
                        <option t-att-value="category.id" t-att-selected="category.id == selected_category and 'selected' or None">
                            <t t-esc="category.name"/>
                        </option>
                    </t>
                </select>
            </div>

            <div class="offset-0 offset-md-1 col-md-5">
                <h5 class="head1 mb-4 fw-bold fontsize-1">Select Treatment</h5>
                <select style="height:25px; width:450px;" name="treatment_id" class="form-select" id="TreatmentSelect" onchange="this.form.submit()">
                    <option value="">-- Select Treatment --</option>
                    <t t-foreach="services" t-as="service">
                        <option t-att-value="service.id" t-att-selected="service.id == selected_treatment and 'selected' or None">
                            <t t-esc="service.name"/>
-                            <t t-esc="service.price_with_currency"/>
                        </option>
                    </t>
                </select>
            </div>
        </div>
        <!-- <t t-if="error_message">
                            <div class="alert alert-danger text-center">
                                <p><t t-esc="error_message" /></p>
                            </div>
                        </t> -->
        <hr/>

        <h5 class="head1 mb-4 fw-bold fontsize-1">Select Doctor</h5>
        <div class="doctor-select mb-4 justify-content-left">
            <t t-foreach="doctors" t-as="doctor">
                <div class="doctor-option text-center" style="margin-right: 20px;">
                    <input type="radio" name="doctor" id="doctor_{{ doctor.id }}" onclick="doctor_add()" t-att-value="doctor.id" t-att-checked="doctor.id == selected_doctor" />
                    <label for="doctor_{{ doctor.id }}">
                        <img t-att-src="'/web/image/appointment.doctors/' + str(doctor.id) + '/image'" alt="Doctor Image" class="doctor-image rounded-circle" style="width: 100px; height: 100px; object-fit: cover;"/>
                        <t t-esc="'Dr. ' + (doctor.fname + ' ' + doctor.lname)"/>
                    </label>
                </div>
            </t>
        </div>
        <!-- <t t-if="doctor_error">
                            <div class="alert alert-danger text-center">
                                <p><t t-esc="doctor_error" /></p>
                            </div>
                        </t> -->

        <hr/>
        <h5 class="head1 mb-4 fw-bold fontsize-1">I'm available on or after</h5>
        <div class="mb-4 w-25">
            <input type="date" class="form-control" id="availableDate" name="available_date" t-att-min="today_date" onchange="date_change()" />
        </div>
        <!-- <t t-if="date_error">
                            <div class="alert alert-danger text-center">
                                <p><t t-esc="date_error" /></p>
                            </div>
                        </t> -->
    </form>

    <div class="row mt-2 p-md-0 justify-content-end">
        <div class="col col-lg-2 text-end">
            <form method="post" action="/booking/step2" onsubmit="return validateForm()">
                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                <input type="hidden" name="sub_doctor_id" id="sub_doctor_id"/>
                <input type="hidden" t-att-value="selected_category" name="sub_category_id" />
                <input type="hidden" t-att-value="selected_treatment" name="sub_service_id" />
                <input type="hidden" name="sub_dates" id="sub_dates"/>
                <button class="btn btn-primary text-center mt-3 px-5 py-3" type="submit">Next</button>
            </form>
        </div>
    </div>
</div>
<br/>
<br/>

<script>
                    function doctor_add() { 
                        var doctor_id = document.querySelector('input[name="doctor"]:checked').value;
                        document.getElementById("sub_doctor_id").value = doctor_id;
                    }

                    function date_change(){
                        var available_date = document.querySelector('input[name="available_date"]').value;
                        document.getElementById("sub_dates").value = available_date;
                    }

                    function validateForm() {
                        var category = document.querySelector('select[name="category_id"]').value;
                        var treatment = document.querySelector('select[name="treatment_id"]').value;
                        var doctor = document.querySelector('input[name="doctor"]:checked');
                        var available_date = document.querySelector('input[name="available_date"]').value;

                        if (!category) {
                            alert("Please select a category.");
                            return false;
                        }
                        if (!treatment) {
                            alert("Please select a treatment.");
                            return false;
                        }
                        if (!doctor) {
                            alert("Please select a doctor.");
                            return false;
                        }
                        if (!available_date) {
                            alert("Please select an available date.");
                            return false;
                        }
                        return true;
                    }
</script>
</t>
</template>
</odoo>

